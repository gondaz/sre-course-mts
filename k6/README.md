# K6

Скрипт хранится в диретории urls/mts
Профиль нагрузки хранится в диретории ammo (они же "патроны")

Приложение "api" имеет нагружается профилем в виде GET запросов по различным ендпоинтам в случайном порядке. 
Прерывание тестирования установлено при невыполнении условия по времени ответа > 6s (99p). SLO  в данном случае: время ответа не выше 6s по 99p
Цель НТ: выяснить максимально возможный RPS при условии следующих лимитов ресуров: 250m(cpu)/128Mi(ram)

В результате тестирования тест прервался преждевременно при достижении RPS 167 и превышении времени ответа по 99p > 6s
Лог k6 приведен ниже:

     █ setup

     data_received..............: 4.7 MB  15 kB/s
     data_sent..................: 8.1 MB  26 kB/s
     dropped_iterations.........: 402     1.28855/s
     http_req_blocked...........: avg=4.91ms   min=1µs     med=6µs      max=519.49ms p(90)=14µs  p(95)=92µs  p(99)=107.53ms
     http_req_connecting........: avg=4.89ms   min=0s      med=0s       max=519.35ms p(90)=0s    p(95)=0s    p(99)=107.37ms
   ✗ http_req_duration..........: avg=630.94ms min=91.08ms med=113.16ms max=8.94s    p(90)=2.22s p(95)=4.16s p(99)=6.12s   
     http_req_failed............: 100.00% ✓ 22702     ✗ 0     
     http_req_receiving.........: avg=66.69µs  min=10µs    med=47µs     max=6.13ms   p(90)=106µs p(95)=148µs p(99)=360µs   
     http_req_sending...........: avg=49.57µs  min=5µs     med=26µs     max=9.61ms   p(90)=70µs  p(95)=120µs p(99)=378.98µs
     http_req_tls_handshaking...: avg=0s       min=0s      med=0s       max=0s       p(90)=0s    p(95)=0s    p(99)=0s      
     http_req_waiting...........: avg=630.82ms min=91.01ms med=113.03ms max=8.94s    p(90)=2.22s p(95)=4.16s p(99)=6.12s   
     http_reqs..................: 22702   72.767819/s
     iteration_duration.........: avg=636.29ms min=69.62µs med=115.06ms max=8.94s    p(90)=2.22s p(95)=4.16s p(99)=6.12s   
     iterations.................: 22702   72.767819/s
     vus........................: 999     min=3       max=1000
     vus_max....................: 1000    min=1000    max=1000


running (05m12.0s), 0000/1000 VUs, 22702 complete and 999 interrupted iterations
contacts ✗ [==================>-------------------] 0998/1000 VUs  05m11.9s/10m0s  0219.87 iters/s

Вероятно узкие места:
1. Проблемы с сетевой связностью с тестируемой машины (локальная АРМ) до ендпоинта ингресса
2. Недостаточное количество ресурсов с тестируемой машины (RAM, opened files, ports, etc) из-за чего в процессе теста начинаются поблемы с доступом до сайта с api
3. Нехватка ресурсов подов/производительности БД

В любом случае в рамках задачи не предполагалcz поиск и решение проблем, а лишь проведение НТ в текущей схеме